<div class="dux-page">
    <div class="page-header">
        头像修改
    </div>
    <div class="page-box">

        <div class="dux-avatar-preview am-cf" id="preview">
            <img src="{url('member/avatar/index', ['id' => $userInfo.user_id,'type' => 3])}" class="am-circle preview-lg" alt="">
            <img src="{url('member/avatar/index', ['id' => $userInfo.user_id,'type' => 2])}" class="am-circle preview-md" alt="">
            <img src="{url('member/avatar/index', ['id' => $userInfo.user_id,'type' => 1])}" class="am-circle preview-sm" alt="">
        </div>

        <div class="am-avatar-btn">
            <form class="am-form am-form-horizontal" action="{url()}" method="post" data-dux="form-bind" data-advanced="false" style="overflow: hidden">
                <span class="am-form-file">
                    <button type="button" class="am-btn am-btn-danger am-btn-sm "><i class="am-icon-photo"></i> 选择头像
                    </button>
                    <input type="file" accept="image/*" name="avatar" id="avatar" style="font-size: 1.4rem;">
                </span>
                <button type="submit" class="am-btn am-btn-success am-btn-sm">
                    保存头像
                </button>
            </form>
        </div>
    </div>

    <script>
        Do('base', function () {

            // 选择图片
            var URL = window.URL || window.webkitURL;
            var blobURL;

            $('#avatar').change(function () {
                var files = this.files;
                var file;
                if (files && files.length) {
                    file = files[0];
                    blobURL = URL.createObjectURL(file);
                    $('#preview').find('img').attr('src', blobURL);
                }
            });

        });
    </script>